
■━ [C#プログラミングレッスン] ━━━━━━━━━━━━━━━ No.290 ━□

 「正規表現編」-- 正規表現とは
                                                            by Gushwell
□━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━■

みなさん、おはようございます。
ブログでもお知らせしましたが、私の書いたC#の書籍が発売されます。
もし、ご興味がありましたら、本屋さんで手にとっていただければ幸いです。

C#プログラミング入門
http://www.amazon.co.jp/exec/obidos/ASIN/4777515982/gaius-22/
2415円

目次は、こちらから確認できます。
http://www.kohgakusha.co.jp/books/detail/978-4-7775-1598-1


それでは、本題に移ります。今回から「正規表現編」を開始します。


■□───────────────────────────────────
■□ はじめに

正規表現（Regular Expression）とは、文字列のパターンを表現する表記法で、
文字列の検査、検索、置換などの処理を行なうときに利用されます。この正規表
現を用いることで、強力で柔軟なテキスト処理を実現できます。

.NET Frameworkの正規表現機能は、基本クラスライブラリに含まれているため、
Windowsフォーム, ASP.NET, WPFなど様々なアプリケーションで利用することがで
きます。

例えば、ある文字列から、「英字で始まりその後数字が5文字以上連続する部分文
字列」を検索したい場合、あなたならどうしますか。
1文字１文字調べ条件に一致するかどうかを調べるコードを書くこともできますが、
とても面倒なコードを書かなくてはなりません。
そんな時に正規表現を使えば、簡単に検索処理を書くことができます。

今回から数回にわたり、.NET Frameworkにある正規表現クラス(Regexクラス)を中
心に正規表現機能について説明して行きます。


■□───────────────────────────────────
■□ 正規表現とは

まずは、正規表現がどんなものか、その雰囲気を知ってもらうために、いくつか
正規表現の例をお見せしましょう。

"[Tt]ime"
 Time または time を表す正規表現

"MS.+"
 MSで始まる3文字以上の文字列を表す正規表現

"[0-9][0-9]"
 2桁の数値を表す正規表現

"\d+時\d+分"
 10時28分 といった時刻を表す正規表現


正規表現文字列の中に現われる [ ] . + \d などは特殊な意味を持ちます。

簡単に説明しましょう。

[Tt]ime
 [] は、文字グループを示します。この場合、Tとtのいずれかと一致することに
 なります。
 別の書き方をすると、 "Time|time" と書けます。  | は「または」の意味にな
 ります。

MS.+
 ピリオド"."は、 改行文字以外の任意の一文字と一致します。
 +は、直前の文字の１回以上の繰り返しに一致します。
 つまり、".+" で任意の文字が１文字以上連続していることを表しますので、
 "MSDN"や "MS-WORD" などと一致します。
 + の代わりに * を使うと、「直前の文字の0回以上の繰り返し」という意味に
 なります。

[0-9][0-9]
 []の中で - を用いるとそれは、文字範囲を示します。
 [0-9] は [0123456789]と同じです。
 [a-z] は、[abcdefghijklmnopqrstuvwxyz] と同じになります。
 例えば、半角の英数字を表したいのならば、[0-9a-zA-Z]と書けます。

\d+時\d+分
 \d は、数字を表します。+ は1回以上の繰り返しになりますので、"23時1234分"
 のような文字列にも一致してしまいます。
 また、\d は、いわゆる全角数字も含まれますので、
 "１２時３４分" といった文字列とも一致することになります。

 ※ 全角、半角という用語以外に良い用語は無いのでしょうか。既にプロポーシ
    ョナルフォントが当たり前の時代に、この用語は実態を反映していない用語
    になっています。1バイト文字、2バイト文字というのも、UNICODE では変だ
    し。便宜上、今後も全角、半角という用語を使うこととします。
    そもそも、全角の数字、英字が存在すること自体変だと思うのですが...
    まあ、ここで愚痴ってもしかたないですね。

気をつけなくてはいけないのは、不用意に正規表現を書いてしまうと、意図した
部分文字列とは別の部分文字列が一致してしまうことがあるということです。
例えば、"MS.+" の場合のピリオドは任意の文字を表しますが、空白文字全角文字
も「任意の文字」ですから、

 MSDN ライブラリ

という文字列が検索対象文字列だとすると、"MSDN"と一致させたくても、"MSDN ラ
イブラリ"の文字列全てに一致してしまいます。

もし、皆さんが正規表現が使えるエディタをお持ちならば、この文章をエディタに
貼り付け、"MS.+"で検索してみてください。もし、"MS.+" という正規表現で "
MSDN"や"MSBuild"という単語と一致させたいのだとしたら、"MS.+" という正規表
現は、とても中途半端なものだということが理解できると思います。

では、どうしたら良いのかは、次号以降徐々に説明していきたいと思います。
今回は、C#のコードをお見せすることができませんでしたが、このあたりで終わ
りにします。

─────────────────────────────────────
『C#プログラミングレッスン』  (ぼぼ週刊）
 ☆皆さまからの感想をお待ちしています。http://gushwell.ifdef.jp/mail.html
─────────────────────────────────────
 Published by Gushwell.
  Copyright (C) 2011 Gushwell All rights reserved.
  Microsoft MVP for Visual C#(Apr 2005 - Mar 2012)

 ■Gushwell's Page
 Gushwell's C# Dev Notes           : http://gushwell.ldblog.jp/
 Gushwell's C# Programming Page    : http://gushwell.ifdef.jp/
 Gushwell's F# Programming Diary   : http://techbank.jp/gushwell/
 Gushwellの読書ノート              : http://gushwell.jugem.jp/
─────────────────────────────────────